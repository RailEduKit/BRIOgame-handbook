%!TEX TS-program = pdflatexmk
%!TEX root = ../handbook.tex

% Copyright 2019 Martin Scheidt (Attribution 4.0 International, CC-BY 4.0)
% You are free to copy and redistribute the material in any medium or format. You are free to remix, transform, and build upon the material for any purpose, even commercially. You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits. No warranties are given.

\part{\IfLanguage{english}{Manual}\IfLanguage{ngerman}{Anleitung}}

\chapter{\IfLanguage{english}{Simulation}\IfLanguage{ngerman}{Simulation}}\label{sec:Simulation}

  \section{\IfLanguage{english}{Line setup}\IfLanguage{ngerman}{Aufbau der Strecke}}
    \IfLanguage{english}{The line consists of any number of spaces. Signals or platforms can be arranged along the line.}
    \IfLanguage{ngerman}{Die Strecke besteht aus einer beliebigen Anzahl von Feldern. An die Strecke können Signale oder Bahnsteigkanten angeordnet werden.}
    \\[0.5cm]
    \tikzfigure{composition.tikz}

  \section{\IfLanguage{english}{Trains}\IfLanguage{ngerman}{Züge}}
   \todo{} (nur Zugfahrten, keine Rangierfahrten)

  \section{\IfLanguage{english}{Round sequence}\IfLanguage{ngerman}{Rundenablauf}}
    \IfLanguage{english}{The simulation is based on rounds. Each round consists of at least two consecutive steps:}
    \IfLanguage{ngerman}{Die Simulation erfolgt Rundenbasiert. Jede Runde besteht aus aufeinanderfolgenden Schritten:}

    \input{\ROOT/src/game_procedure.tex}

    \IfLanguage{english}{At the start of the game, the train stands still. Shift lever positions start at the ``$0$'' field.
    The different train dynamics are depicted by different possible movements of the shift lever.}
    \IfLanguage{ngerman}{Beim Start des Spiels steht der Zug. Schalthebelposition beginnen bei dem Feld ``$0$''.
    Die unterschiedliche Fahrdynamik von Zügen wird durch unterschiedliche mögliche Schalthebelbewegung abgebildet.}

  \section{\IfLanguage{english}{Example of a simulated train movements}\IfLanguage{ngerman}{Beispiel einer simulierten Zugbewegung}}
    \IfLanguage{english}{The shift lever is moved along the green arrows. Shift lever positions for a passenger train:}
    \IfLanguage{ngerman}{Der Schalthebel wird entlang der grünen Pfeile bewegt. Schalthebelpositionen für einen Personenzug:}
    \begin{center}
      \tikzfigure[0.8\textwidth]{control_lever.tikz}
    \end{center}
    \vspace*{0.5cm}
    \IfLanguage{english}{A train is supposed to accelerate on the following track:}
    \IfLanguage{ngerman}{Ein Zug soll auf folgender Strecke beschleunigen:}
    \\
    \tikzfigure{initial_setup.tikz}
    \\[0.5cm]
    \IfLanguage{english}{ For the course of the learning game, we start with the first round and follow the process from the previous section \emph{\nameref{sec:Simulation}}.
    In the first round, the train from the initial condition stands still. In the example there are no signals that can be set.
    We can move the shift lever by one position to \SI{40}{\kilo\metre\per\hour} forward. The round is over.}
    \IfLanguage{ngerman}{Für den Verlauf des Lernspiels beginnen wir mit der ersten Runde und befolgen den Ablauf aus vorheringen Abschnitt \emph{\nameref{sec:Simulation}}.
    In der ersten Runde steht der Zug aus der Anfangsbedingung. Im Beispiel gibt es keine Signale die eingestellt werden können.
    Wir können den Schalthebel um eine Position auf \SI{40}{\kilo\metre\per\hour} nach vorne bewegen. Die Runde ist beendet.}

    \IfLanguage{english}{ The second round begins with the execution of the movement one field to the right.
    The shift lever can be moved on and the round is over.
    The third round begins with the execution of the movement by \emph{two} fields to the right.
    The shift lever can be moved on again and the round is over.
    Continue until the position of \SI{120}{\kilo\metre\per\hour} is reached and the train moves evenly with three fields per round.}
    \IfLanguage{ngerman}{Die zweite Runde beginnt mit dem Ausführen der Bewegung um ein Feld nach rechts.
    Der Schalthebel kann wieder weiterbewegt werden und die Runde ist damit beendet.
    Die dritte Runde beginnt mit dem Ausführen der Bewegung um \emph{zwei} Felder nach rechts.
    Der Schalthebel kann wieder weiterbewegt werden und die Runde ist damit beendet.
    Und so weiter, bis man auf der Position auf \SI{120}{\kilo\metre\per\hour} angekommen ist und der Zug sich gleichmäßig mit drei Felder pro Runde weiter bewegt.}
    \\[0.5cm]
    \input{\ROOT/tables/example_movement.tex}

\chapter{\IfLanguage{english}{Block section}\IfLanguage{ngerman}{Blockteilung}}

  \section{\IfLanguage{english}{Block section setup}\IfLanguage{ngerman}{Anordnung von Blocken}}
    \IfLanguage{english}{The main signal may only show the proceed aspect if there is no train in the following block section (from track vacancy detector to track vacancy detector).
    The distant signal is located in front of the main signal in braking distance and reflects the signal aspect of the main signal.}
    \IfLanguage{ngerman}{Das Hauptsignal darf nur Fahrt zeigen, wenn im nachfolgenden Blockabschnitt (von Gleisfreimeldegrenze zu Gleisfreimeldegrenze) kein Zug ist.
    Das Vorsignal steht im Bremswegabstand vor dem Hauptsignal und spiegelt den Signalbegriff vom Hauptsignal.}
    \begin{center}
      \input{\ROOT/tables/signal_aspects.tex}
    \end{center}

  \section{\IfLanguage{english}{Example of a train running through a block}\IfLanguage{ngerman}{Beispiel einer Zugfahrt durch einen Block}}
   \todo{}


\chapter{\IfLanguage{english}{routes}\IfLanguage{ngerman}{Fahrstraßen}}

  \section{\IfLanguage{english}{route setup}\IfLanguage{ngerman}{Anordnung von Fahrstraßen}}
   \todo{}

  \section{\IfLanguage{english}{Example of a train using a route}\IfLanguage{ngerman}{Beispiel einer Zugfahrt durch eine Fahrstraße}}
   \todo{}
